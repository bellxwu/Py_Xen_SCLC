'''Description: Testing the xenium outputs with pandas to get sense of what eachfile is. '''# %% Set directoryimport xen_config as xcimport pandas as pdimport matplotlib.pyplot as pltimport osimport h5py as h5pyimport zarrimport tifffile as tfdir_64312 = xc.xen_dir / "SCLC_64312"os.chdir(dir_64312)# %% Load objects as pd filescell_bound = pd.read_csv("cell_boundaries.csv.gz")cells = pd.read_csv("cells.csv.gz")nuc_bound = pd.read_csv("nucleus_boundaries.csv.gz")met_summ = pd.read_csv("metrics_summary.csv")# %% Understanding file content of cell_boundariescell_bound.shapecell_bound.head(100)# identify number of unique cells and vertices contributing to cellcell_bound['cell_id'].nunique()cell_vertices = cell_bound['cell_id'].value_counts()# plot densitycell_vertices.plot(kind='density')plt.xlabel('Value')plt.title('Density plot of values')plt.show()# filter out vertices less than 25cell_vertices_u25 = cell_vertices[cell_vertices < 25] # only 2213 cell IDs < 252213 / 283748 * 100 # ~1% of cells less than 25# plot density u25cell_vertices_u25.plot(kind='density')plt.xlabel('Value')plt.title('Density plot of values')plt.show()'''The files here contain the cell boundaries and the vertices used to define thecell boundaries. I assume nucleus_boundaries.csv.gz is the same but for nuclei.Why do roughly 1% of cells have much lower vertices for their polygon masks?Can I find a way to visualize these cells?'''# %% Understanding cells.csvcells.shapecells.columns'''The files here contain the values I would need for QC, in particular the codewords and counts. '''# %% Understanding metrics_summary.csvmet_summ.shapemet_summ.columns# %% Loading H5 data typescell_feat = h5py.File('cell_feature_matrix.h5', 'r+')list(cell_feat.keys()) # determine datasets withintype(cell_feat)# assign groupsfeat_mat = cell_feat['matrix']# probe h5 outputtype(feat_mat) # a .Group filelist(feat_mat.keys())# probe the "barcodes" datasetbarcodes = feat_mat['barcodes']type(barcodes)barcodes.shapebarcodes.dtypebarcodes = pd.Series(barcodes)# probe "data" datasetdata = feat_mat['data']data.shapedata.dtypedata = pd.Series(data)# probe "features" groupfeatures = feat_mat['features']type(features)list(features.keys())# explore entire hierarchydef print_info(name, obj):    if isinstance(obj, h5py.Group):        print(f"[Group] {name}")    elif isinstance(obj, h5py.Dataset):        print(f"[Dataset] {name} | {obj.shape}  | {obj.dtype}")    feat_mat.visititems(print_info)# %% Exploring .zarr filesprint(zarr.__version__) # ensure downloaded version compatible with .ZipStore# load cells.zarr.zipstore = zarr.ZipStore("cells.zarr.zip", mode = "r")cells_zarr = zarr.group(store)cells_zarr.infocells_zarr.tree()# load analysis.zarr.zipstore = zarr.ZipStore("analysis.zarr.zip", mode = "r")ana_zarr = zarr.group(store)ana_zarr.infoana_zarr.tree()# %% Exploring .ome.tiff filesimg = tf.imread("morphology.ome.tif")img.shapeplt.imshow(img[10][::20, ::20], cmap='gray')  # Show the first z-slice of first channelplt.show()t_img = tf.TiffFile("morphology.ome.tif") # loads into a TiffFile objectprint(t_img.ome_metadata) # prints metadata on OME-XMLlen(t_img.pages) # prints number of 2D sliceslen(t_img.series) # prints number of image seriest_img.series[0].shape # prints shape of first series (12, 37457, 22805)test = enumerate(list(range(4)))next(test)