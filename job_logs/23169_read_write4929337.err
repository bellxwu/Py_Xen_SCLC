/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/dask/dataframe/__init__.py:31: FutureWarning: The legacy Dask DataFrame implementation is deprecated and will be removed in a future version. Set the configuration option `dataframe.query-planning` to `True` or None to enable the new Dask Dataframe implementation and silence this warning.
  warnings.warn(
/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/xarray_schema/__init__.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import DistributionNotFound, get_distribution
/cluster/home/bellwu/Py_Xenium/analyses/02_xen_qc/scripts/xenium_zarr.py:20: DeprecationWarning: `cell_boundaries` is being deprecated as an argument to `xenium.xenium` in SpatialData version 0.1, switch to `cells_boundaries` instead.
  sdata = si.xenium(path = dir_23169,
/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/functools.py:909: ImplicitModificationWarning: Transforming to str index.
  return dispatch(args[0].__class__)(*args, **kw)
Traceback (most recent call last):
  File "/cluster/home/bellwu/Py_Xenium/analyses/02_xen_qc/scripts/xenium_zarr.py", line 27, in <module>
    adata.write(dir_23169 / "23169.h5ad")
  File "/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/legacy_api_wrap/__init__.py", line 88, in fn_compatible
    return fn(*args_all, **kw)
           ^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/anndata/_core/anndata.py", line 1885, in write_h5ad
    write_h5ad(
  File "/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/anndata/_io/utils.py", line 325, in raise_error_if_dataset_2d_present
    return write(store, adata, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/anndata/_io/h5ad.py", line 81, in write_h5ad
    with h5py.File(filepath, mode) as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/h5py/_hl/files.py", line 566, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xen_reader/lib/python3.11/site-packages/h5py/_hl/files.py", line 247, in make_fid
    fid = h5f.create(name, h5f.ACC_TRUNC, fapl=fapl, fcpl=fcpl)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 124, in h5py.h5f.create
PermissionError: [Errno 13] Unable to synchronously create file (unable to open file: name = '/cluster/home/bellwu/lokgroup/Xenium_runs/20241212__190528__Lok_Jalal_241210/output-XETG00082__0051610__23169__20241212__190621/23169.h5ad', errno = 13, error message = 'Permission denied', flags = 13, o_flags = 242)
