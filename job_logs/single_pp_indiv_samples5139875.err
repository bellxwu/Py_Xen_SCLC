/cluster/home/bellwu/Py_Xenium/analyses/02_xen_qc/h4h_scripts/single_pp_indiv_samples.py:48: ImplicitModificationWarning: Setting element `.layers['counts']` of view, initializing view as actual.
  SampleAnnData.layers["counts"] = SampleAnnData.X.copy()
Traceback (most recent call last):
  File "/cluster/home/bellwu/Py_Xenium/analyses/02_xen_qc/h4h_scripts/single_pp_indiv_samples.py", line 54, in <module>
    sc.pp.pca(SampleAnnData,
  File "/cluster/home/bellwu/miniconda3/envs/xenium-env/lib/python3.11/site-packages/scanpy/preprocessing/_pca/__init__.py", line 349, in pca
    x_pca = pca_.fit_transform(x)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xenium-env/lib/python3.11/site-packages/sklearn/utils/_set_output.py", line 316, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xenium-env/lib/python3.11/site-packages/sklearn/base.py", line 1365, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xenium-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 466, in fit_transform
    U, S, _, X, x_is_centered, xp = self._fit(X)
                                    ^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xenium-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 542, in _fit
    return self._fit_truncated(X, n_components, xp)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/bellwu/miniconda3/envs/xenium-env/lib/python3.11/site-packages/sklearn/decomposition/_pca.py", line 717, in _fit_truncated
    raise ValueError(
ValueError: n_components=196686 must be between 1 and min(n_samples, n_features)=5001 with svd_solver='arpack'
